<section>
  <div class="w-full flex justify-content-between align-items-center py-3">
    <h1 class="font-semibold text-lg mb-5">Movimentações</h1>

    <app-menu [items]="menuItens" #menu />
    <button
      pButton
      [label]="titles[(movimentsService.formType$ | async) || 0]"
      icon="pi pi-chevron-down"
      type="button"
      class="surface-900 border-black-alpha-90"
      (click)="menu.toggle($event)"
    >
      &nbsp;
    </button>
  </div>

  <moviments-list *ngIf="!(formTypes | async)" />

  <div [class.card]="formTypes | async">
    <purchase-form *ngIf="(formTypes | async) === 1" />
    <fixed-income-form *ngIf="(formTypes | async) === 6" />
    <dividends-form *ngIf="(formTypes | async) === 3" />
    <sell-form *ngIf="(formTypes | async) === 2" />
    <split-form *ngIf="(formTypes | async) === 4" />

    <ng-container *ngIf="movimentsService.formType$ | async as formSelected">
      <div class="mt-5" *ngIf="tableContent && tableContent.length">
        <div class="pb-5 flex justify-content-between border-bottom-1 border-200">
          <h1 class="font-semibold m-0">Resumo</h1>
          <strong>Total: {{ total | currency: 'BRL' }}</strong>
        </div>

        <p-table [value]="tableContent">
          <ng-template pTemplate="header">
            <tr>
              <th>Cod.</th>
              <th>Operação</th>
              <th>Tipo</th>
              <th>quantidade</th>
              <th>Valor unitário</th>
              <th>Taxa</th>
              <th>Total</th>
              <th class="text-center">Remover</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-item>
            <tr>
              <td>{{ item.cod }}</td>
              <td>{{ item.type_operation_title }}</td>
              <td>{{ item.type_title }}</td>
              <td>
                <span class="ml-5">{{ item.qtd }}</span>
              </td>
              <td>
                {{ item.unity_value | currency: 'BRL' }}
              </td>
              <td>
                {{ (item.fee | currency: 'BRL' : 'symbol' : '1.3-3') || '---' }}
              </td>
              <td>{{ item.total | currency: 'BRL' }}</td>
              <td class="text-center">
                <button
                  class="icon-trash-2 accio-table__action cursor-pointer"
                  (click)="removeItemFromSession(sessionsNames[formSelected - 1], item.id)"
                ></button>
              </td>
            </tr>
          </ng-template>
        </p-table>
        <div class="mt-7 flex justify-content-center">
          <p-button
            label="Salvar"
            severity="contrast"
            type="button"
            (click)="saveMoviments()"
            [loading]="savingLoader"
          />
        </div>
      </div>
    </ng-container>
  </div>
</section>
